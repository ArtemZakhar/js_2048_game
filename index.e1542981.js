!function(){var t,e,n,r,o,i,a,u,l={};function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}}function h(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var d="idle",v="playing",y=function(t){for(var e=Math.floor(4*Math.random());!t[e].includes(0);)e=Math.floor(4*Math.random());for(var n=Math.floor(4*Math.random());0!==t[e][n];)n=Math.floor(4*Math.random());return[e,n]},m=function(t){var e,n=t.map(function(t){return h(t)}),r=.9>=Math.random()?2:4,o=function(t){if(Array.isArray(t))return t}(e=y(n))||function(t,e){var n,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i=[],a=!0,u=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(t){u=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(u)throw r}}return i}}(e,2)||f(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],a=o[1];return n[i][a]=r,n},g=function(){var t=m([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);return m(t)},p=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=[t.length-1,t[t.length-1][n]],o=null,i=t.length-1;i>=0;i-=1){var a=t[i][n];if(0===a){if(null!==o)continue;o=i;continue}if(r[1]===a&&r[0]!==i){t[r[0]][n]=2*a,t[i][n]=0,o=i,r[0]-=1,i+=1,r[1]=t[r[0]][n],e=!1;continue}if(null!==o){t[o][n]=a,r[0]=o,r[1]=a,o-=1,t[i][n]=0,e=!1;continue}if(r[1]!==a){r[0]-=1,r[1]=a;continue}}return!e&&t},S=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=t[n],o=[0,r[0]],i=null,a=0;a<r.length;a+=1){var u=r[a];if(0===u){if(null!==i)continue;i=a;continue}if(o[1]===u&&o[0]!==a){t[n][o[0]]=2*u,t[n][a]=0,i=a,o[0]+=1,a-=1,o[1]=t[a][o[0]],e=!1;continue}if(null!==i){t[n][i]=u,o[0]=i,o[1]=u,i+=1,t[n][a]=0,e=!1;continue}if(o[1]!==u){o[0]+=1,o[1]=u;continue}}return!e&&t},b=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=t[n],o=[r.length-1,r[r.length-1]],i=null,a=r.length-1;a>=0;a-=1){var u=r[a];if(0===u){if(null!==i)continue;i=a;continue}if(o[1]===u&&o[0]!==a){t[n][o[0]]=2*u,t[n][a]=0,i=a,o[0]-=1,a+=1,o[1]=t[a][o[0]],e=!1;continue}if(null!==i){t[n][i]=u,o[0]=i,o[1]=u,i-=1,t[n][a]=0,e=!1;continue}if(o[1]!==u){o[0]-=1,o[1]=u;continue}}return!e&&t},w=function(t){for(var e=!0,n=0;n<t.length;n+=1)for(var r=[0,t[0][n]],o=null,i=0;i<t.length;i+=1){var a=t[i][n];if(0===a){if(null!==o)continue;o=i;continue}if(r[1]===a&&r[0]!==i){t[r[0]][n]=2*a,t[i][n]=0,o=i,r[0]+=1,i-=1,r[1]=t[r[0]][n],e=!1;continue}if(null!==o){t[o][n]=a,r[0]=o,r[1]=a,o+=1,t[i][n]=0,e=!1;continue}if(r[1]!==a){r[0]+=1,r[1]=a;continue}}return!e&&t},k=function(t){h(document.querySelector("tbody").children).forEach(function(e,n){h(e.children).forEach(function(e,r){if(e.children.length)e.lastChild.classList.add("hide"),new Promise(function(t){setTimeout(function(){return t()},75)}).then(function(){e.removeChild(e.lastChild);var o=document.createElement("div");o.classList.add("field-cell"),o.style.cssText="display: flex; justify-content: center; align-items: center;";var i=t[n][r];i&&o.classList.add("field-cell--".concat(i)),o.textContent=0===i?"":i,e.append(o)});else{var o=document.createElement("div");o.classList.add("field-cell"),o.style.cssText="display: flex; justify-content: center; align-items: center;";var i=t[n][r];i&&o.classList.add("field-cell--".concat(i)),o.textContent=0===i?"":i,e.append(o)}})})};l=function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),c(this,"state",[]),c(this,"status",d),this.state=t}return t=[{key:"moveLeft",value:function(){if(this.getStatus()===v){var t=S(this.getState());this.applyChanges(t)}}},{key:"moveRight",value:function(){if(this.getStatus()===v){var t=b(this.getState());this.applyChanges(t)}}},{key:"moveUp",value:function(){if(this.getStatus()===v){var t=w(this.getState());this.applyChanges(t)}}},{key:"moveDown",value:function(){if(this.getStatus()===v){var t=p(this.getState());this.applyChanges(t)}}},{key:"getScore",value:function(){return this.status===d?0:this.state.flat().reduce(function(t,e){return t+e},0)}},{key:"getState",value:function(){return this.state.map(function(t){return h(t)})}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=v,k(this.getState())}},{key:"restart",value:function(){this.state=g(),k(this.getState())}},{key:"applyChanges",value:function(t){if(t){if(this.isFull(t)){this.gameOver();return}var e=m(t);this.state=e,k(e),this.has2048(this.state)&&this.winner()}}},{key:"isFull",value:function(t){return t.flat().every(function(t){return 0!==t})}},{key:"gameOver",value:function(){this.status="lose",document.querySelector(".message-lose").classList.remove("hidden")}},{key:"has2048",value:function(t){return t.flat().includes(2048)}},{key:"winner",value:function(){this.status="win",document.querySelector(".message-win").classList.remove("hidden")}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}();var C=document.querySelector(".controls button"),L=document.querySelector(".game-score"),x=new l(g());document.body.style.overflowY="hidden",C.addEventListener("click",function(){C.classList.contains("start")?(C.classList.remove("start"),C.classList.add("restart"),C.textContent="Restart",x.start()):x.restart(),document.querySelector(".message-start").classList.add("hidden");var t=x.getScore();L.textContent=t}),document.addEventListener("keydown",function(t){if("ArrowRight"===t.key){x.moveRight();var e=x.getScore();L.textContent=e}if("ArrowLeft"===t.key){x.moveLeft();var n=x.getScore();L.textContent=n}if("ArrowUp"===t.key){x.moveUp();var r=x.getScore();L.textContent=r}if("ArrowDown"===t.key){x.moveDown();var o=x.getScore();L.textContent=o}}),t=function(){Math.abs(r-o)>Math.abs(i-a)?(r-o>u&&x.moveLeft(),o-r>u&&x.moveRight()):(i-a>u&&x.moveUp(),a-i>u&&x.moveDown());var t=x.getScore();n.textContent=t},e=document.querySelector("tbody"),n=document.querySelector(".game-score"),r=0,o=0,i=0,a=0,u=20,e.addEventListener("touchstart",function(t){r=t.changedTouches[0].screenX,i=t.changedTouches[0].screenY}),e.addEventListener("touchend",function(e){o=e.changedTouches[0].screenX,a=e.changedTouches[0].screenY,t()})}();
//# sourceMappingURL=index.e1542981.js.map
